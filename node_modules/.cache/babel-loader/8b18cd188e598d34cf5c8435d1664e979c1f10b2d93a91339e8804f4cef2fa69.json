{"ast":null,"code":"import JSZip from'jszip';/**\n * Downloads a zip file and extracts image files from it\n * @param zipUrl - URL to the zip file\n * @returns Array of base64 data URLs for the images\n */export const downloadAndExtractImages=async zipUrl=>{try{console.log('Downloading zip file:',zipUrl);// Download the zip file\nconst response=await fetch(zipUrl);if(!response.ok){throw new Error(\"Failed to download zip file: \".concat(response.status,\" \").concat(response.statusText));}const zipBlob=await response.blob();console.log('Zip file downloaded, size:',zipBlob.size,'bytes');// Load the zip file\nconst zip=new JSZip();const loadedZip=await zip.loadAsync(zipBlob);const imageDataUrls=[];const imageExtensions=['.png','.jpg','.jpeg','.gif','.bmp','.webp'];// Extract image files\nfor(const[filename,file]of Object.entries(loadedZip.files)){// Skip directories\nif(file.dir)continue;// Check if it's an image file\nconst isImage=imageExtensions.some(ext=>filename.toLowerCase().endsWith(ext));if(isImage){console.log('Extracting image:',filename);try{// Get the file as blob\nconst imageBlob=await file.async('blob');// Convert to data URL\nconst dataUrl=await new Promise((resolve,reject)=>{const reader=new FileReader();reader.onload=()=>resolve(reader.result);reader.onerror=reject;reader.readAsDataURL(imageBlob);});imageDataUrls.push(dataUrl);}catch(error){console.error(\"Failed to extract \".concat(filename,\":\"),error);}}}console.log(\"Extracted \".concat(imageDataUrls.length,\" images from zip\"));return imageDataUrls;}catch(error){console.error('Error downloading/extracting zip:',error);throw error;}};/**\n * Downloads and extracts images from multiple zip files\n * @param zipUrls - Array of zip file URLs\n * @returns Array of base64 data URLs for all images\n */export const downloadAndExtractMultipleZips=async zipUrls=>{const allImages=[];for(let i=0;i<zipUrls.length;i++){try{console.log(\"Processing zip file \".concat(i+1,\"/\").concat(zipUrls.length));const images=await downloadAndExtractImages(zipUrls[i]);allImages.push(...images);}catch(error){console.error(\"Failed to process zip file \".concat(i+1,\":\"),error);// Continue with other zip files even if one fails\n}}return allImages;};","map":{"version":3,"names":["JSZip","downloadAndExtractImages","zipUrl","console","log","response","fetch","ok","Error","concat","status","statusText","zipBlob","blob","size","zip","loadedZip","loadAsync","imageDataUrls","imageExtensions","filename","file","Object","entries","files","dir","isImage","some","ext","toLowerCase","endsWith","imageBlob","async","dataUrl","Promise","resolve","reject","reader","FileReader","onload","result","onerror","readAsDataURL","push","error","length","downloadAndExtractMultipleZips","zipUrls","allImages","i","images"],"sources":["/Users/fabio/Coding/bytenite-git/pocs/sv-demo-night/src/services/zipUtils.ts"],"sourcesContent":["import JSZip from 'jszip';\n\n/**\n * Downloads a zip file and extracts image files from it\n * @param zipUrl - URL to the zip file\n * @returns Array of base64 data URLs for the images\n */\nexport const downloadAndExtractImages = async (zipUrl: string): Promise<string[]> => {\n    try {\n        console.log('Downloading zip file:', zipUrl);\n        \n        // Download the zip file\n        const response = await fetch(zipUrl);\n        if (!response.ok) {\n            throw new Error(`Failed to download zip file: ${response.status} ${response.statusText}`);\n        }\n        \n        const zipBlob = await response.blob();\n        console.log('Zip file downloaded, size:', zipBlob.size, 'bytes');\n        \n        // Load the zip file\n        const zip = new JSZip();\n        const loadedZip = await zip.loadAsync(zipBlob);\n        \n        const imageDataUrls: string[] = [];\n        const imageExtensions = ['.png', '.jpg', '.jpeg', '.gif', '.bmp', '.webp'];\n        \n        // Extract image files\n        for (const [filename, file] of Object.entries(loadedZip.files)) {\n            // Skip directories\n            if (file.dir) continue;\n            \n            // Check if it's an image file\n            const isImage = imageExtensions.some(ext => \n                filename.toLowerCase().endsWith(ext)\n            );\n            \n            if (isImage) {\n                console.log('Extracting image:', filename);\n                \n                try {\n                    // Get the file as blob\n                    const imageBlob = await file.async('blob');\n                    \n                    // Convert to data URL\n                    const dataUrl = await new Promise<string>((resolve, reject) => {\n                        const reader = new FileReader();\n                        reader.onload = () => resolve(reader.result as string);\n                        reader.onerror = reject;\n                        reader.readAsDataURL(imageBlob);\n                    });\n                    \n                    imageDataUrls.push(dataUrl);\n                } catch (error) {\n                    console.error(`Failed to extract ${filename}:`, error);\n                }\n            }\n        }\n        \n        console.log(`Extracted ${imageDataUrls.length} images from zip`);\n        return imageDataUrls;\n        \n    } catch (error) {\n        console.error('Error downloading/extracting zip:', error);\n        throw error;\n    }\n};\n\n/**\n * Downloads and extracts images from multiple zip files\n * @param zipUrls - Array of zip file URLs\n * @returns Array of base64 data URLs for all images\n */\nexport const downloadAndExtractMultipleZips = async (zipUrls: string[]): Promise<string[]> => {\n    const allImages: string[] = [];\n    \n    for (let i = 0; i < zipUrls.length; i++) {\n        try {\n            console.log(`Processing zip file ${i + 1}/${zipUrls.length}`);\n            const images = await downloadAndExtractImages(zipUrls[i]);\n            allImages.push(...images);\n        } catch (error) {\n            console.error(`Failed to process zip file ${i + 1}:`, error);\n            // Continue with other zip files even if one fails\n        }\n    }\n    \n    return allImages;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}